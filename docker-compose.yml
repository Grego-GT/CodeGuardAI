services:
  # GitHub MCP HTTP Server
  # MCP-compatible server that provides GitHub API access over HTTP
  # Accessible from E2B sandboxes at localhost:8080
  github-mcp:
    build:
      context: ./mcp_proxy
      dockerfile: Dockerfile
    container_name: codeguard-github-mcp
    ports:
      - "8080:8080"
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
    restart: unless-stopped
    networks:
      - codeguard-network

  # Optional: Perplexity MCP for AI-powered insights
  # perplexity-mcp:
  #   image: mcp/perplexity-server:latest
  #   container_name: codeguard-perplexity-mcp
  #   ports:
  #     - "8081:8080"
  #   environment:
  #     - PERPLEXITY_API_KEY=${PERPLEXITY_API_KEY}
  #   restart: unless-stopped
  #   networks:
  #     - codeguard-network

networks:
  codeguard-network:
    driver: bridge

# Note: E2B sandboxes can connect to these MCP servers via:
# - localhost:8080 (if running on same machine)
# - host.docker.internal:8080 (from inside E2B sandbox)
# - Or configure ngrok for remote access
